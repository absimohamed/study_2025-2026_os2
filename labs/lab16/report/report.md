---
## Front matter
title: "Отчёт по лабораторной работе №16"
subtitle: "Программный RAID"
author: "Лабси Мохаммед"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Освоить работу с RAID-массивами при помощи утилиты mdadm.

# Ход выполнения

## Создание RAID-массива

1. Получены права суперпользователя.  

2. Проверено наличие добавленных дисков. В системе отобразились устройства **/dev/sdd**, **/dev/sde**, **/dev/sdf**.

   ![Проверка дисков](Screenshot_1.png){ #fig:001 width=80% }

3. На каждом из дисков создан один раздел. Разделы созданы успешно, что подтверждается выводом утилиты `sfdisk`.

4. Проверен тип созданных разделов. Все разделы имели тип **83 (Linux)**.

   ![Проверка типов разделов](Screenshot_2.png){ #fig:002 width=80% }

5. Просмотрены доступные типы партиций RAID. Обнаружен тип **fd — Linux raid autodetect**.

6. Тип всех разделов изменён на **fd (Linux raid autodetect)**.

7. Выполнена дополнительная проверка состояния дисков. Все три раздела отображаются как **Linux raid autodetect**.

   ![Состояние разделов](Screenshot_3.png){ #fig:003 width=80% }

8. Убедились, что утилита mdadm установлена в системе.

9. Создан RAID-массив уровня 1 на основе разделов **/dev/sdd1** и **/dev/sde1**.

   ![Создание RAID](Screenshot_4.png){ #fig:004 width=80% }

10. Проверено состояние массива. Массив находится в состоянии **clean**, оба устройства активны и синхронизированы.

   ![Состояние массива](Screenshot_5.png){ #fig:005 width=80% }

11. На массиве создана файловая система ext4.

   ![Создание ФС](Screenshot_6.png){ #fig:006 width=80% }

12. Создан каталог для монтирования и выполнено подключение RAID-массива в каталог **/data/raid**.

13. В файл **/etc/fstab** добавлена строка для автоматического монтирования массива при загрузке:

   ![fstab](Screenshot_7.png){ #fig:007 width=80% }

14. Выполнена имитация сбоя одного из дисков массива (диск **/dev/sde1** был отмечен как неисправный).

15. Сбойный диск удалён из массива.

16. В массив добавлен новый диск **/dev/sdf1**.

17. Проверено состояние массива. Массив пересобран, активны устройства **/dev/sdd1** и **/dev/sdf1**, состояние массива — **clean**.

   ![Пересборка массива](Screenshot_8.png){ #fig:008 width=80% }

18. RAID-массив удалён. Файловая система размонтирована, массив остановлен, метаданные на всех дисках очищены.

   ![Удаление массива](Screenshot_9.png){ #fig:009 width=80% }

## RAID-массив с горячим резервом (Hot Spare)

1. Получены права суперпользователя.

2. Создан массив RAID 1 из двух дисков **/dev/sdd1** и **/dev/sde1**.

   ![Создание RAID1](Screenshot_10.png){ #fig:010 width=80% }

3. В массив добавлен третий диск **/dev/sdf1**, который автоматически назначен hot-spare.

4. Массив подмонтирован в файловую систему.

5. Просмотрено состояние массива. Отчёт показывает:
   - уровень массива: **raid1**  
   - активные устройства: **2**  
   - рабочие устройства: **3**  
   - одно устройство находится в состоянии **spare**  

   ![Состояние массива с hotspare](Screenshot_11.png){ #fig:011 width=80% }

6. Сымитирован сбой одного диска (**/dev/sde1**).  

7. Проверено состояние массива после сбоя.  
   В отчёте видно:
   - один диск стал **faulty**,  
   - hot-spare (**/dev/sdf1**) автоматически активировался  
   - массив пересобирается корректно и остаётся в состоянии **clean**

   ![Сбой и автопересборка массива](Screenshot_12.png){ #fig:012 width=80% }

8. Массив удалён, метаданные RAID очищены.

## Преобразование RAID 1 в RAID 5

1. Получены права суперпользователя.

2. Создан массив RAID 1 из дисков **/dev/sdd1** и **/dev/sde1**.

3. В массив добавлен третий диск **/dev/sdf1**, который стал резервным.

4. RAID подмонтирован, работоспособность массива подтверждена.

   ![Состояние RAID1 с резервом](Screenshot_13.png){ #fig:013 width=80% }
   
   ![Состояние RAID1 с резервом](Screenshot_14.png){ #fig:014 width=80% }


5. Выполнено преобразование массива RAID 1 в RAID 5.  
   Уровень массива изменён на **raid5**, что подтверждено отчётом:

   ![Преобразование в RAID5](Screenshot_15.png){ #fig:015 width=80% }

6. Изменено количество рабочих дисков массива — теперь RAID 5 использует **3 диска**.  
   Состояние массива обновлено, активны три устройства.

   ![RAID5 с тремя рабочими дисками](Screenshot_16.png){ #fig:016 width=80% }

7. RAID-массив остановлен и удалён, метаданные очищены.

8. Запись в `/etc/fstab`, относящаяся к `/dev/md0`, закомментирована.

## Контрольные вопросы

1. **Приведите определение RAID.**  
   RAID — это технология объединения нескольких физических дисков в единый логический массив с целью повышения отказоустойчивости, производительности или сочетания этих параметров.  
   Массив работает как одно устройство, а распределение данных между дисками осуществляется по определённым алгоритмам.

2. **Какие типы RAID-массивов существуют на сегодняшний день?**  
   Существуют следующие основные уровни RAID:
   - RAID 0  
   - RAID 1  
   - RAID 2 (практически не используется)  
   - RAID 3 (редко применяется)  
   - RAID 4  
   - RAID 5  
   - RAID 6  
   - RAID 10 (1+0)  
   - RAID 50, RAID 60 (составные уровни)  
   Отдельно выделяют *hot spare* — резервные диски, автоматически включающиеся в работу при сбое.

3. **Охарактеризуйте RAID 0, RAID 1, RAID 5, RAID 6. Опишите алгоритм работы, назначение и примеры применения.**  

   **RAID 0 (Striping)**  
   Алгоритм: данные равномерно распределяются по всем дискам массива без дублирования.  
   Назначение: максимальное повышение производительности.  
   Применение: системы, где важна скорость — обработка видео, временные файлы, кеши.  
   Недостаток: выход из строя любого диска приводит к полной потере данных.

   **RAID 1 (Mirroring)**  
   Алгоритм: данные полностью копируются на два и более дисков.  
   Назначение: обеспечение высокой отказоустойчивости.  
   Применение: серверы баз данных, критически важные сервисы, рабочие станции с повышенными требованиями к сохранности данных.  
   Особенность: при отказе одного диска данные сохраняются полностью.

   **RAID 5 (Striping + Distributed Parity)**  
   Алгоритм: данные и информация чётности равномерно распределяются по всем дискам.  
   Назначение: баланс между производительностью, ёмкостью и отказоустойчивостью.  
   Применение: файловые серверы, корпоративные системы хранения, серверы виртуализации.  
   Особенность: допускает отказ одного диска без потери данных.

   **RAID 6 (Striping + Double Parity)**  
   Алгоритм: используется двухкратная чётность, распределённая по всем дискам массива.  
   Назначение: максимальная надёжность при доступной ёмкости.  
   Применение: крупные СХД, архивы, резервные хранилища, где возможны длительные операции восстановления.  
   Особенность: допускает отказ двух дисков одновременно.

# Заключение

В ходе выполнения лабораторной работы были изучены и practically освоены методы настройки и администрирования программных RAID-массивов в Linux. Рассмотрены создание RAID 1, работа с горячим резервом, имитация отказов устройств, автоматическая реконфигурация массива, а также преобразование RAID 1 в RAID 5. Получены навыки анализа состояния массива, управления его конфигурацией и удаления RAID с последующей очисткой метаданных.  
